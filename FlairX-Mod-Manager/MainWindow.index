COMPONENT: MainWindow (SPLIT INTO 6 PARTIAL CLASSES)
DESCRIPTION: Main application window with navigation, game selection, search functionality, backdrop effects, and comprehensive UI management
REDUCTION: Original 2,628 lines → 587 lines main file (77.7% reduction)
TOTAL CODE LINES: 2,665 lines across 6 files (main: 587 + hotkeys: 376 + navigation: 235 + window: 285 + events: 534 + ui: 444 + xml: 246)

================================================================================
FILE: MainWindow.xaml (UNCHANGED)
TOTAL LINES: 246

LINE RANGES:
├── Window Declaration: lines 1-10
│   ├── Class definition: line 2
│   └── Namespace declarations: lines 3-10
├── Main Grid Layout: lines 14-245
│   ├── NavigationView: lines 15-233
│   │   ├── NavigationView properties: lines 15-28
│   │   ├── PaneHeader (Game Selection): lines 30-72
│   │   │   ├── Game selection ComboBox: lines 31-71
│   │   │   │   ├── Select Game item: lines 33-39
│   │   │   │   ├── Genshin Impact item: lines 40-46
│   │   │   │   ├── Honkai Impact 3rd item: lines 47-53
│   │   │   │   ├── Honkai Star Rail item: lines 54-60
│   │   │   │   ├── Wuthering Waves item: lines 61-67
│   │   │   │   └── Zenless Zone Zero item: lines 68-72
│   │   ├── MenuItems: lines 74-76 (empty)
│   │   ├── FooterMenuItems: lines 78-104
│   │   │   ├── Other Mods item: lines 79-83
│   │   │   ├── Functions item: lines 84-88
│   │   │   └── Settings item: lines 89-103
│   │   ├── PaneCustomContent: lines 106-232
│   │   │   ├── Main StackPanel: lines 107-231
│   │   │   │   ├── Title and progress: lines 108-110
│   │   │   │   ├── Search and buttons grid: lines 111-140
│   │   │   │   │   ├── Search box: lines 115-125
│   │   │   │   │   ├── Reload button: lines 126-134
│   │   │   │   │   └── Restart button: lines 135-143
│   │   │   │   └── Action buttons grid: lines 144-230
│   │   │   │       ├── All mods button: lines 150-155
│   │   │   │       ├── View mode toggle: lines 156-165
│   │   │   │       ├── Open mod library: lines 166-175
│   │   │   │       └── Show active mods: lines 176-188
│   │   └── Content Frame: line 233
│   ├── Zoom Indicator: lines 235-243
│   │   ├── Border container: lines 235-241
│   │   └── Zoom text: lines 242-243
│   └── Launcher FAB: lines 245-253
│       ├── Border container: lines 245-251
│       └── Launcher icon: line 252

UI ELEMENTS:
- MainRoot: line 14 - Main grid container for backdrop effects
- nvSample: lines 15-233 - Main navigation view
- GameSelectionComboBox: lines 31-71 - Game selection dropdown
- SearchBox: lines 115-125 - Search functionality with animated icon
- ReloadModsButton: lines 126-134 - Reload mods button (&#xE72C;)
- RestartAppButton: lines 135-143 - Restart application button (&#xE895;)
- AllModsButton: lines 150-155 - All mods navigation button
- ViewModeToggleButton: lines 156-165 - Toggle view mode button (&#xE8A9;)
- OpenModLibraryButton: lines 166-175 - Open mod library button (&#xE8DA;)
- ShowActiveModsButton: lines 176-188 - Show active mods button with heart icons
- ZoomIndicatorBorder: lines 235-243 - Zoom level indicator
- LauncherFabBorder: lines 245-253 - Floating action button for launcher (&#xE768;)

================================================================================
FILE: MainWindow.xaml.cs (MAIN PARTIAL CLASS)
TOTAL LINES: 587

LINE RANGES:
├── Using statements: lines 1-24
├── Namespace declaration: lines 26-27
├── MainWindow class (partial): lines 28-694
│   ├── Constants and fields: lines 29-50
│   │   ├── Window size constants: lines 29-31
│   │   ├── Language dictionary: line 32
│   │   ├── Menu item collections: lines 39-40
│   │   ├── State flags: lines 42-43
│   │   └── Backdrop fields: lines 45-49
│   ├── Constructor: lines 51-200
│   │   ├── Component initialization: lines 52-53
│   │   ├── Language loading: line 54
│   │   ├── Tooltip setup: lines 56-60
│   │   ├── View mode initialization: line 62
│   │   ├── Game selection setup: line 65
│   │   ├── Window configuration: lines 67-75
│   │   ├── Theme application: lines 77-110
│   │   ├── Backdrop initialization: lines 112-114
│   │   ├── Window state management: lines 116-130
│   │   ├── Event handlers: lines 132-150
│   │   ├── UI initialization: lines 152-180
│   │   └── Global hotkey handler: lines 182-200
│   ├── Core UI Methods: lines 202-250
│   │   ├── SetSearchBoxPlaceholder: lines 202-210
│   │   └── SetFooterMenuTranslations: lines 212-250
│   ├── Position Memory System: lines 252-420
│   │   ├── GetCurrentViewMode: lines 252-260
│   │   ├── GetCurrentViewModeString: lines 262-270
│   │   ├── SaveCurrentPositionBeforeReload: lines 272-310
│   │   ├── DoesCategoryExist: lines 312-330
│   │   └── RestoreLastPosition: lines 332-420
│   ├── View Mode Management: lines 422-520
│   │   ├── UpdateViewModeButtonIcon: lines 422-440
│   │   ├── IsCurrentlyInCategoryMode: lines 442-450
│   │   ├── InitializeViewModeFromSettings: lines 452-470
│   │   ├── RestoreViewModeButtonFromSettings: lines 472-480
│   │   ├── UpdateViewModeTooltip: lines 482-490
│   │   ├── UpdateMenuItemsEnabledState: lines 492-505
│   │   ├── UpdateAllModsButtonText: lines 507-515
│   │   └── UpdateAllModsButtonState: lines 517-520
│   ├── Menu Generation: lines 522-680
│   │   ├── GenerateModCharacterMenuAsync: lines 522-670
│   │   └── EnsurePresetsMenuItemExists: lines 672-680
│   └── Helper Classes: lines 682-694
│       └── WindowsSystemDispatcherQueueHelper: lines 682-694

================================================================================
FILE: MainWindow.UIManagement.cs
TOTAL LINES: 444

LINE RANGES:
├── Using statements: lines 1-9
├── Namespace declaration: lines 11-12
├── MainWindow class (partial - UI Management): lines 13-444
│   ├── UI Utility Methods: lines 14-100
│   │   ├── UpdateGameSelectionComboBoxTexts: lines 14-25
│   │   ├── CenterWindow: lines 27-40
│   │   ├── GetXXMILauncherPath: lines 42-55
│   │   ├── CreateXXMIDownloadContent: lines 57-80
│   │   └── LogToGridLog: lines 82-100
│   ├── Game Selection Management: lines 102-126
│   │   └── RestoreGameSelection: lines 102-126
│   ├── Menu Generation: lines 128-216
│   │   ├── GenerateModCharacterMenuAsync: lines 128-186
│   │   └── EnsurePresetsMenuItemExists: lines 188-216
│   ├── Image Management: lines 218-316
│   │   └── PreloadModImages: lines 218-316
│   ├── Language and UI Refresh: lines 318-408
│   │   └── RefreshUIAfterLanguageChange: lines 318-408
│   ├── Game Selection UI: lines 410-438
│   │   └── UpdateUIForGameSelection: lines 410-438
│   └── Animation Control: lines 440-444
│       └── UpdateOrangeAnimationVisibility: lines 440-444

================================================================================
FILE: MainWindow.Hotkeys.cs
TOTAL LINES: 376

LINE RANGES:
├── Using statements: lines 1-13
├── Namespace declaration: lines 15-16
├── MainWindow class (partial - Hotkeys): lines 17-376
│   └── Global Hotkey System: lines 18-376
│       ├── MainWindow_KeyDown: lines 18-85
│       │   ├── Game selection validation: lines 18-26
│       │   ├── Modifier key detection: lines 28-36
│       │   ├── Hotkey string building: lines 38-42
│       │   └── Hotkey matching and execution: lines 44-85
│       ├── ExecuteOptimizePreviewsHotkey: lines 87-150
│       │   ├── Settings validation: lines 87-95
│       │   ├── Navigation to SettingsPage: lines 97-105
│       │   ├── Reflection method invocation: lines 107-125
│       │   └── Error handling: lines 127-150
│       ├── ExecuteReloadManagerHotkey: lines 152-180
│       │   ├── Validation and setup: lines 152-160
│       │   ├── ReloadModsAsync call: lines 162-170
│       │   └── Error handling: lines 172-180
│       ├── ExecuteShuffleActiveModsHotkey: lines 182-346
│       │   ├── Settings validation: lines 182-190
│       │   ├── Directory scanning: lines 192-210
│       │   ├── Category filtering: lines 212-230
│       │   ├── Random selection logic: lines 232-290
│       │   ├── Active mods management: lines 292-320
│       │   ├── File saving: lines 322-340
│       │   └── Error handling: lines 342-346
│       └── ExecuteDeactivateAllModsHotkey: lines 348-376
│           ├── Settings validation: lines 348-356
│           ├── Active mods clearing: lines 358-370
│           └── Error handling: lines 372-376

================================================================================
FILE: MainWindow.Navigation.cs
TOTAL LINES: 235

LINE RANGES:
├── Using statements: lines 1-12
├── Namespace declaration: lines 14-15
├── MainWindow class (partial - Navigation): lines 16-235
│   ├── SetSearchBoxPlaceholder: lines 17-25
│   ├── SetFooterMenuTranslations: lines 27-65
│   │   ├── Footer menu items setup: lines 27-40
│   │   ├── Translation updates: lines 42-60
│   │   └── Icon assignments: lines 62-65
│   ├── UpdateShowActiveModsButtonIcon: lines 67-95
│   │   ├── Button reference: lines 67-70
│   │   ├── Icon state logic: lines 72-85
│   │   └── Heart icon updates: lines 87-95
│   ├── NavigationView_SelectionChanged: lines 97-165
│   │   ├── Event validation: lines 97-105
│   │   ├── Category navigation: lines 107-135
│   │   ├── Special page navigation: lines 137-155
│   │   └── Error handling: lines 157-165
│   ├── NavigationView_PaneClosing: lines 167-175
│   ├── NavigationView_PaneOpening: lines 177-185
│   ├── SearchBox_TextChanged: lines 187-215
│   │   ├── Empty search handling: lines 187-200
│   │   ├── Menu regeneration: lines 202-210
│   │   └── Filter application: lines 212-215
│   └── SearchBox_QuerySubmitted: lines 217-235
│       ├── Query validation: lines 217-225
│       ├── Navigation to ModGridPage: lines 227-230
│       └── Search execution: lines 232-235

================================================================================
FILE: MainWindow.WindowManagement.cs
TOTAL LINES: 285

LINE RANGES:
├── Using statements: lines 1-15
├── DLL imports and constants: lines 17-25
├── Namespace declaration: lines 27-28
├── MainWindow class (partial - Window Management): lines 29-285
│   ├── Window State Management: lines 30-120
│   │   ├── DisableMaximizeOnDoubleClick: lines 30-42
│   │   ├── RestoreWindowState: lines 44-80
│   │   │   ├── Window handle retrieval: lines 44-50
│   │   │   ├── Size restoration: lines 52-58
│   │   │   ├── Position restoration: lines 60-70
│   │   │   └── Maximized state restoration: lines 72-80
│   │   ├── SaveWindowState: lines 82-105
│   │   │   ├── Window handle retrieval: lines 82-88
│   │   │   ├── Size and position capture: lines 90-98
│   │   │   └── Settings save: lines 100-105
│   │   └── CenterWindow: lines 107-120
│   ├── Theme Management: lines 122-160
│   │   └── ApplyThemeToTitleBar: lines 122-160
│   │       ├── Window handle setup: lines 122-128
│   │       ├── Light theme colors: lines 130-138
│   │       ├── Dark theme colors: lines 140-148
│   │       └── Auto theme colors: lines 150-160
│   └── Backdrop System: lines 162-285
│       ├── ApplyBackdropEffect: lines 162-240
│       │   ├── Controller disposal: lines 162-170
│       │   ├── Background clearing: lines 172-178
│       │   ├── Mica effects: lines 180-220
│       │   ├── Acrylic effects: lines 222-235
│       │   └── None effect handling: lines 237-240
│       ├── TrySetAcrylicBackdrop: lines 242-260
│       ├── Backdrop event handlers: lines 262-285
│       │   ├── Window_Activated: lines 262-270
│       │   ├── Window_Closed: lines 272-280
│       │   └── Window_ThemeChanged: lines 282-285

================================================================================
FILE: MainWindow.EventHandlers.cs
TOTAL LINES: 534

LINE RANGES:
├── Using statements: lines 1-16
├── Namespace declaration: lines 18-19
├── MainWindow class (partial - Event Handlers): lines 20-534
│   ├── Initialization Event Handlers: lines 21-35
│   │   ├── NvSample_Loaded: lines 21-25
│   │   └── MainRoot_Loaded: lines 27-35
│   ├── Button Event Handlers: lines 37-220
│   │   ├── ReloadModsButton_Click: lines 37-45
│   │   ├── AllModsButton_Click: lines 47-75
│   │   ├── ViewModeToggleButton_Click: lines 77-140
│   │   ├── ShowActiveModsButton events: lines 142-145
│   │   ├── OpenModLibraryButton_Click: lines 147-150
│   │   └── ReloadModsAsync: lines 152-220
│   ├── Game Selection System: lines 222-370
│   │   ├── GameSelectionComboBox_SelectionChanged: lines 222-340
│   │   ├── LauncherFabBorder_Tapped: lines 342-365
│   │   └── RestartAppButton_Click: lines 367-370
│   ├── Application Management: lines 372-404
│   │   └── RestartApplication: lines 372-404
│   └── Additional UI Events: lines 406-534
│       ├── LauncherFabBorder_PointerPressed: lines 406-470
│       ├── LauncherFabBorder_PointerEntered: lines 472-475
│       ├── LauncherFabBorder_PointerExited: lines 477-480
│       ├── LauncherFabBorder_PointerWheelChanged: lines 482-490
│       ├── ZoomIndicatorBorder_PointerWheelChanged: lines 492-500
│       ├── UpdateZoomIndicator: lines 502-515
│       └── CleanupSymlinksForGameSwitch: lines 517-534

GAME SELECTION SYSTEM:
- ComboBox with 6 games: Select Game, GIMI, HIMI, SRMI, WWMI, ZZMI
- Per-game path configuration and switching
- Symlink cleanup on game changes
- StatusKeeper watcher management per game
- UI state management based on game selection
- Welcome page display when no game selected

NAVIGATION SYSTEM:
- NavigationView with dynamic menu generation
- Category-based navigation from mod library structure
- Footer menu items: Other Mods, Functions, Settings, Presets
- Search-based filtering of navigation items
- View mode dependent navigation behavior
- Active mods special navigation with heart icon

SEARCH FUNCTIONALITY:
- AutoSuggestBox with animated search icon
- Dynamic search (3+ characters) with real-time filtering across all mods
- Static search (2+ characters) on query submission across all mods
- Always navigates to ModGridPage and loads all mods for comprehensive search
- Menu item filtering based on search query
- Search box focus restoration after navigation
- Category mode: Returns to ModGridPage with LoadAllCategories() after clearing search
- Mods mode: Remains on ModGridPage after clearing search

POSITION MEMORY SYSTEM:
- Automatic position saving before reload operations
- Category title analysis to determine current location
- Category existence validation before navigation
- Graceful fallback to appropriate default views
- Position clearing for invalid saved locations
- Support for both default and category view modes
- Integration with SettingsManager for persistence
- Restoration of menu item selection state

VIEW MODE SYSTEM:
- Toggle between Mods and Categories view modes
- Settings persistence for view mode preference
- Button icon updates based on current mode
- Menu item enabling/disabling in category mode
- All Mods/All Categories button text switching
- Tooltip updates for view mode toggle

HOTKEY SYSTEM:
- Global keyboard event handling at window level
- Modifier key detection (Ctrl, Shift, Alt)
- Hotkey string building and matching
- Four configurable hotkeys: Optimize Previews, Reload Manager, Shuffle Active Mods, Deactivate All Mods
- Settings integration for hotkey configuration
- Action execution with proper error handling

BACKDROP EFFECTS:
- Mica: Base and BaseAlt variants
- Acrylic: Base and Thin variants
- None: Solid color backgrounds matching theme
- Theme-aware backdrop configuration
- Automatic fallback for unsupported systems
- Controller lifecycle management

THEME SYSTEM:
- Light/Dark/Auto theme support
- Title bar color customization per theme
- Theme-aware backdrop effects
- Background color management for None effect
- Theme change event handling
- Settings integration for theme persistence

WINDOW MANAGEMENT:
- Window state persistence (size, position, maximized)
- Minimum and maximum size constraints
- Window centering on first launch
- Title bar customization with transparency
- Application icon setting
- Window event handling for state changes

UI STATE MANAGEMENT:
- Game selection dependent UI enabling/disabling
- Menu item state management
- Button state updates based on context
- Progress bar visibility control
- Search box state management
- Launcher FAB interaction states

LANGUAGE SYSTEM:
- Dynamic language dictionary loading
- UI text updates on language change
- Page-specific language refresh
- Tooltip translation updates
- Menu item text translation
- Placeholder text translation

MENU GENERATION:
- Dynamic category menu from mod library structure
- Mod directory scanning and categorization
- Menu item creation with icons and tags
- Category filtering (excluding "Other" from menu)
- Presets menu item management
- Menu state updates based on view mode

ERROR HANDLING:
- Try-catch blocks for all major operations
- Graceful fallback for missing resources
- Debug logging for troubleshooting
- User-friendly error dialogs
- Safe operations with validation
- Exception isolation between components

INTEGRATION:
- SettingsManager integration for all settings
- SharedUtilities integration for common operations
- PathManager integration for file paths
- Logger integration for debugging
- StatusKeeper integration for sync management
- ModGridPage integration for content display

PERFORMANCE:
- Asynchronous operations for UI responsiveness
- Background task execution for heavy operations
- Efficient menu generation and updates
- Smart UI updates only when needed
- Memory management for backdrop controllers
- Optimized search and filtering operations

ACCESSIBILITY:
- Keyboard navigation support
- Screen reader friendly elements
- High contrast theme support
- Proper focus management
- Tooltip integration for all interactive elements
- Consistent UI patterns and behaviors
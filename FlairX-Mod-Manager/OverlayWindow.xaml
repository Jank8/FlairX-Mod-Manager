<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="FlairX_Mod_Manager.OverlayWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:FlairX_Mod_Manager"
    Title="FlairX Overlay">

    <Grid x:Name="MainRoot" Background="Transparent">
        <Grid.RowDefinitions>
            <RowDefinition Height="32"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Custom Title Bar -->
        <Grid x:Name="AppTitleBar" Grid.Row="0" Background="Transparent">
            <StackPanel Orientation="Horizontal" Margin="12,0,0,0" VerticalAlignment="Center">
                <Image Source="Assets/app.ico" Width="16" Height="16" Margin="0,0,8,0"/>
                <TextBlock Text="FlairX Mod Manager" FontSize="12" VerticalAlignment="Center"/>
            </StackPanel>
        </Grid>

        <!-- Content -->
        <Grid Grid.Row="1" Padding="8,0,8,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Category Icons Column -->
            <ScrollViewer Grid.Column="0" Grid.Row="0"
                          VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Disabled"
                          Margin="0,0,4,0">
                <ItemsRepeater x:Name="CategoriesRepeater" 
                               ItemsSource="{x:Bind OverlayCategories}">
                    <ItemsRepeater.Layout>
                        <StackLayout Orientation="Vertical" Spacing="4"/>
                    </ItemsRepeater.Layout>
                    <ItemsRepeater.ItemTemplate>
                        <DataTemplate x:DataType="local:OverlayCategoryItem">
                            <Grid Width="40" Height="40" 
                                  Margin="4"
                                  CornerRadius="4"
                                  Background="{x:Bind SelectionBackground, Mode=OneWay}"
                                  PointerPressed="CategoryItem_PointerPressed"
                                  ToolTipService.ToolTip="{x:Bind Name}">
                                <Border CornerRadius="4">
                                    <Image Source="{x:Bind Thumbnail}" 
                                           Stretch="UniformToFill"/>
                                </Border>
                                <!-- Selection indicator -->
                                <Border CornerRadius="4"
                                        BorderBrush="{x:Bind SelectionBorder, Mode=OneWay}"
                                        BorderThickness="2"/>
                            </Grid>
                        </DataTemplate>
                    </ItemsRepeater.ItemTemplate>
                </ItemsRepeater>
            </ScrollViewer>

            <!-- Mod List -->
            <ScrollViewer Grid.Column="1" Grid.Row="0" 
                          VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Disabled">
                <ItemsRepeater x:Name="ModsRepeater" 
                               ItemsSource="{x:Bind OverlayMods}">
                    <ItemsRepeater.Layout>
                        <StackLayout Orientation="Vertical" Spacing="4"/>
                    </ItemsRepeater.Layout>
                    <ItemsRepeater.ItemTemplate>
                        <DataTemplate x:DataType="local:OverlayModItem">
                            <Grid Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                                  CornerRadius="4" 
                                  Padding="8"
                                  PointerPressed="ModItem_PointerPressed">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="48"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- Thumbnail -->
                                <Border Grid.Column="0" 
                                        Width="40" Height="40" 
                                        CornerRadius="4"
                                        Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}">
                                    <Image Source="{x:Bind Thumbnail}" 
                                           Stretch="UniformToFill"/>
                                </Border>

                                <!-- Name -->
                                <TextBlock Grid.Column="1" 
                                           Text="{x:Bind Name}" 
                                           VerticalAlignment="Center"
                                           Margin="8,0"
                                           TextTrimming="CharacterEllipsis"/>

                                <!-- Status -->
                                <Border Grid.Column="2" 
                                        Width="12" Height="12" 
                                        CornerRadius="6"
                                        Background="{x:Bind StatusColor}"
                                        VerticalAlignment="Center"/>
                            </Grid>
                        </DataTemplate>
                    </ItemsRepeater.ItemTemplate>
                </ItemsRepeater>
            </ScrollViewer>

            <!-- Footer -->
            <StackPanel Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="1" 
                        Orientation="Horizontal" 
                        HorizontalAlignment="Center"
                        Margin="0,8,0,0"
                        Spacing="8">
                <TextBlock x:Name="HotkeyHintText"
                           Text="Alt+W to hide" 
                           Opacity="0.5"
                           FontSize="11"/>
                <TextBlock Text="â€¢" 
                           Opacity="0.5"
                           FontSize="11"/>
                <TextBlock Text="Click to toggle" 
                           Opacity="0.5"
                           FontSize="11"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>
